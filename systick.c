/**********************************************************************************************************************
 *  FILE DESCRIPTION
 *  -----------------------------------------------------------------------------------------------------------------*/
/**        \file  systick.c
 *        \brief  
 *
 *      \details  
 *
 *
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  INCLUDES
 *********************************************************************************************************************/
#include "systick_config.h"
#include "systick.h"
#include "tm4creg.h" 
#include "reg_access.h"

/**********************************************************************************************************************
*  LOCAL MACROS CONSTANT\FUNCTION
*********************************************************************************************************************/

/**********************************************************************************************************************
 *  LOCAL DATA 
 *********************************************************************************************************************/
static void (* call_back_var) (void)  ; 
/**********************************************************************************************************************
 *  GLOBAL DATA
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  LOCAL FUNCTION PROTOTYPES
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  LOCAL FUNCTIONS
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  GLOBAL FUNCTIONS
 *********************************************************************************************************************/


/******************************************************************************
* \Syntax          : void systick_init(void)        
* \Description     : initialize systck according to the config parameters                                   
*                                                                             
* \Sync\Async      : Synchronous                                               
* \Reentrancy      : Non Reentrant                                             
* \Parameters (in) : None                  
* \Parameters (out): None                                                      
* \Return value:   : None                                  
*******************************************************************************/
void systick_init(void)
{
	NVIC_ST_RELOAD_R = Reload_value ;
	if (INTEN == 1)   /*set interrupt enable/disable*/ 
	   {
			set_bit(NVIC_ST_CTRL_R,INTEN_shift) ; 
	   }
		 else
		 {
			     if (INTEN == 0)   
	         {
		      	reset_bit(NVIC_ST_CTRL_R,INTEN_shift) ; 
	         }
		       else
		       {
						/*do nothing*/ 
		       }
		 }
		 
		 if (CLC_SRC == 1)   /*set systick clock source*/ 
	   {
			set_bit(NVIC_ST_CTRL_R,CLC_SRC_shift) ; 
	   }
		 else
		 {
			     if (CLC_SRC == 0)   
	         {
		      	reset_bit(NVIC_ST_CTRL_R,CLC_SRC_shift) ; 
	         }
		       else
		       {
						/*do nothing*/ 
		       }
		 }
		
		
}
/******************************************************************************
* \Syntax          : void systick_start (void)      
* \Description     : starts the systick time                                   
*                                                                             
* \Sync\Async      : Synchronous                                               
* \Reentrancy      : Non Reentrant                                             
* \Parameters (in) : None                    
* \Parameters (out): None                                                      
* \Return value:   : None                                 
*******************************************************************************/
void systick_start (void)
{
	set_bit(NVIC_ST_CTRL_R,en_shift) ; 
}
/******************************************************************************
* \Syntax          : void systick_stop (void)      
* \Description     : stops the systick time                                   
*                                                                             
* \Sync\Async      : Synchronous                                               
* \Reentrancy      : Non Reentrant                                             
* \Parameters (in) : None                    
* \Parameters (out): None                                                      
* \Return value:   : None                                 
*******************************************************************************/
void systick_stop (void)
{
	reset_bit(NVIC_ST_CTRL_R,en_shift) ;
}
/******************************************************************************
* \Syntax          : void callback_reg (void (* call_back) (void) )        
* \Description     : register the app fun to be called inside systick ISR                                   
*                                                                             
* \Sync\Async      : Synchronous                                               
* \Reentrancy      : Non Reentrant                                             
* \Parameters (in) : call_back   the APP function                     
* \Parameters (out): None                                                      
* \Return value:   : None                                  
*******************************************************************************/
void callback_reg (void (* call_back) (void) ) 
{
	call_back_var = call_back ; 
	
}

/*systick ISR*/
static void SysTick_Handler (void)
{
  call_back_var() ; 	
	
}
/**********************************************************************************************************************
 *  END OF FILE: systick.c
 *********************************************************************************************************************/
